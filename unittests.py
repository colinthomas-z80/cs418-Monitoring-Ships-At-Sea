import unittest as test
import create_database
import mysqlutils
import tmb_dao
from mysql.connector import Error


class ais_unit_tests(test.TestCase):

    # Tests unit tester
    def test_if_true(self):
        self.assertTrue(True, "Pass")

    def test_if_false(self):
        self.assertFalse(False, "Pass")

    # Unit Tests for create_database.py
    def test_create_database(self):
        create_database
        error = False
        try:
            mysqlutils.SQL_runner().run("USE AISDraft")
            mysqlutils.SQL_runner().run("DESCRIBE AISDraft.vessel")
        except Exception:
            error = True
        self.assertFalse(error)

    # Unit Tests for tmb_dao.py

    def test_read_position_by_mmsi(self):
        expected = "[(244089000, Decimal('57.077635'), Decimal('8.203543'), datetime.datetime(2020, 11, 18, 0, 0, 2))]"
        # query = "SELECT MMSI, Latitude, Longitude, max(Timestamp) FROM AISDraft.POSITION_REPORT, AISDraft.AIS_MESSAGE WHERE POSITION_REPORT.AISMessage_Id = AIS_MESSAGE.Id AND AIS_MESSAGE.MMSI = 244089000 GROUP BY MMSI, Latitude, Longitude;"
        actual = tmb_dao.tmb_dao().read_position_by_mmsi(244089000)
        self.assertEqual(expected, str(actual))


    def test_read_last_5_positions(self):
        # tmb_dao.tmb_dao().read_last_5_positions(244089000)
        #expected = "[[], (244089000, Decimal('57.077635'), Decimal('8.203543')), (244089000, Decimal('57.077635'), Decimal('8.203543'))]"
        expected = "[(244089000, Decimal('57.077635'), Decimal('8.203543'))]"
        query = "SELECT MMSI, Latitude, Longitude FROM AISDraft.POSITION_REPORT, AISDraft.AIS_MESSAGE WHERE POSITION_REPORT.AISMessage_Id = AIS_MESSAGE.Id AND AIS_MESSAGE.MMSI = 244089000 ORDER BY Timestamp LIMIT 5;"
        actual = tmb_dao.tmb_dao().read_last_5_positions(244089000)
        self.assertEqual(expected, str(actual))

    def test_read_recent_vessel_positions(self):
        error = False
        try:
            print(tmb_dao.tmb_dao().read_recent_vessel_positions())
        except:
            error = True
        #expected = "[[(219000333, Decimal('57.713883'), Decimal('10.580337'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(265522240, Decimal('57.707242'), Decimal('11.699915'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219018494, Decimal('56.958633'), Decimal('8.366383'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219000431, Decimal('54.513033'), Decimal('11.238133'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219000762, Decimal('55.911902'), Decimal('10.258980'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219001236, Decimal('57.048537'), Decimal('10.052263'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219001343, Decimal('57.592667'), Decimal('9.965267'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219014012, Decimal('55.475305'), Decimal('8.424293'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(211235220, Decimal('54.471140'), Decimal('12.523390'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(304217000, Decimal('54.652750'), Decimal('15.134965'), datetime.datetime(2020, 11, 18, 0, 0, 2)), (304217000, Decimal('54.652738'), Decimal('15.134840'), datetime.datetime(2020, 11, 18, 0, 0))], [(265779630, Decimal('57.670563'), Decimal('11.849402'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(2190047, Decimal('55.697250'), Decimal('12.613717'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(256174000, Decimal('54.782413'), Decimal('10.819247'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219001549, Decimal('57.123368'), Decimal('8.598835'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219622000, Decimal('56.033122'), Decimal('12.617203'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(244110544, Decimal('56.679333'), Decimal('12.170667'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219006622, Decimal('57.139585'), Decimal('9.127253'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(538007450, Decimal('55.024545'), Decimal('13.846865'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(245391000, Decimal('55.481025'), Decimal('14.732997'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(376503000, Decimal('54.519373'), Decimal('11.479140'), datetime.datetime(2020, 11, 18, 0, 0))], [(219014161, Decimal('56.693812'), Decimal('8.222775'), datetime.datetime(2020, 11, 18, 0, 0))], [(265650970, Decimal('57.623668'), Decimal('11.809950'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219024411, Decimal('57.117967'), Decimal('8.590317'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265572330, Decimal('57.109035'), Decimal('12.242472'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219004596, Decimal('57.593497'), Decimal('9.956770'), datetime.datetime(2020, 11, 18, 0, 0))], [(636018844, Decimal('55.240710'), Decimal('5.954442'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219862000, Decimal('55.471832'), Decimal('8.424750'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(259893000, Decimal('57.717248'), Decimal('10.590880'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219110000, Decimal('57.555167'), Decimal('11.305033'), datetime.datetime(2020, 11, 18, 0, 0))], [(265514800, Decimal('55.613622'), Decimal('12.997392'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265547210, Decimal('57.643820'), Decimal('11.858140'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219000775, Decimal('56.701592'), Decimal('8.220973'), datetime.datetime(2020, 11, 18, 0, 0))], [(265663280, Decimal('57.681952'), Decimal('11.870367'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(246476000, Decimal('55.430543'), Decimal('5.348280'), datetime.datetime(2020, 11, 18, 0, 0, 3)), (246476000, Decimal('55.430573'), Decimal('5.348287'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219001061, Decimal('54.571708'), Decimal('11.928870'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(257018000, Decimal('57.716242'), Decimal('10.583765'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(257403000, Decimal('57.437603'), Decimal('10.543495'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(266254000, Decimal('57.683380'), Decimal('11.648918'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219001604, Decimal('56.127610'), Decimal('12.310342'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(257555000, Decimal('57.028470'), Decimal('7.355113'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(636018753, Decimal('56.186038'), Decimal('6.931600'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(258763000, Decimal('55.591847'), Decimal('12.699158'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2190071, Decimal('57.110038'), Decimal('8.648282'), datetime.datetime(2020, 11, 18, 0, 0))], [(2655185, Decimal('56.226938'), Decimal('14.775362'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(636019497, Decimal('58.080398'), Decimal('11.225117'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(304010366, Decimal('54.779168'), Decimal('15.347672'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(220259000, Decimal('55.676770'), Decimal('11.091103'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(2190048, Decimal('56.079107'), Decimal('12.129563'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219007034, Decimal('57.716230'), Decimal('10.586508'), datetime.datetime(2020, 11, 18, 0, 0))], [(236213000, Decimal('57.757052'), Decimal('10.965845'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(271045707, Decimal('57.440083'), Decimal('8.886267'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(266454000, Decimal('55.493712'), Decimal('12.710327'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(220079000, Decimal('57.122567'), Decimal('8.599733'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(265828500, Decimal('56.199300'), Decimal('12.546188'), datetime.datetime(2020, 11, 18, 0, 0))], [(219000855, Decimal('57.321535'), Decimal('11.126175'), datetime.datetime(2020, 11, 18, 0, 0))], [(2655140, Decimal('56.053638'), Decimal('12.707640'), datetime.datetime(2020, 11, 18, 0, 0))], [(265547270, Decimal('57.653297'), Decimal('11.799440'), datetime.datetime(2020, 11, 18, 0, 0))], [(219025976, Decimal('57.716717'), Decimal('10.582078'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(373465000, Decimal('54.430988'), Decimal('11.914742'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(211447960, Decimal('54.472595'), Decimal('9.027368'), datetime.datetime(2020, 11, 18, 0, 0))], [(211227530, Decimal('54.814258'), Decimal('9.454653'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219001682, Decimal('57.123897'), Decimal('8.600443'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(305313000, Decimal('54.359377'), Decimal('10.019077'), datetime.datetime(2020, 11, 18, 0, 0))], [(230006000, Decimal('55.394333'), Decimal('12.661500'), datetime.datetime(2020, 11, 18, 0, 0))], [(257120500, Decimal('57.721450'), Decimal('10.599322'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219016615, Decimal('55.972425'), Decimal('11.367762'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(231112000, Decimal('55.476953'), Decimal('8.415955'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(246330000, Decimal('57.545587'), Decimal('11.274893'), datetime.datetime(2020, 11, 18, 0, 0))], [(219297000, Decimal('55.588948'), Decimal('4.758748'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2655148, Decimal('57.108762'), Decimal('12.390500'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(538007975, Decimal('57.766832'), Decimal('10.260775'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219007606, Decimal('57.593325'), Decimal('9.961082'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219004043, Decimal('55.087300'), Decimal('8.565317'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219005302, Decimal('54.816223'), Decimal('11.017885'), datetime.datetime(2020, 11, 18, 0, 0))], [(230011000, Decimal('55.264183'), Decimal('13.026650'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(220043000, Decimal('57.120583'), Decimal('8.599218'), datetime.datetime(2020, 11, 18, 0, 0))], [(219661000, Decimal('57.117218'), Decimal('8.591442'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(2190068, Decimal('56.447257'), Decimal('10.945875'), datetime.datetime(2020, 11, 18, 0, 0))], [(219016747, Decimal('55.004533'), Decimal('12.756462'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(220251000, Decimal('54.854167'), Decimal('10.522655'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(265177000, Decimal('57.605248'), Decimal('11.654410'), datetime.datetime(2020, 11, 18, 0, 0)), (265177000, Decimal('57.605408'), Decimal('11.654870'), datetime.datetime(2020, 11, 18, 0, 0, 4)), (265177000, Decimal('57.605328'), Decimal('11.654640'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219024177, Decimal('56.123998'), Decimal('12.477750'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(636018490, Decimal('54.424450'), Decimal('11.666900'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219003452, Decimal('55.593962'), Decimal('12.676968'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219011857, Decimal('55.880550'), Decimal('11.136540'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(636091859, Decimal('54.443975'), Decimal('11.886380'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(2655125, Decimal('56.174227'), Decimal('15.601643'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219002801, Decimal('57.720655'), Decimal('10.603313'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(304944000, Decimal('54.208523'), Decimal('9.573637'), datetime.datetime(2020, 11, 18, 0, 0))], [(209869000, Decimal('55.312107'), Decimal('13.132065'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(255805841, Decimal('57.912773'), Decimal('9.160130'), datetime.datetime(2020, 11, 18, 0, 0))], [(219009591, Decimal('57.592820'), Decimal('9.955437'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(636092241, Decimal('55.329202'), Decimal('14.570297'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219001695, Decimal('55.473452'), Decimal('8.425790'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219867000, Decimal('56.701298'), Decimal('8.223455'), datetime.datetime(2020, 11, 18, 0, 0))], [(244645000, Decimal('57.716367'), Decimal('10.597600'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000907, Decimal('57.443067'), Decimal('10.548117'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(265866000, Decimal('54.763183'), Decimal('12.415067'), datetime.datetime(2020, 11, 18, 0, 0))], [(266331000, Decimal('55.694982'), Decimal('10.811843'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219022323, Decimal('55.104852'), Decimal('14.694062'), datetime.datetime(2020, 11, 18, 0, 0))], [(219027804, Decimal('55.942460'), Decimal('11.866297'), datetime.datetime(2020, 11, 18, 0, 0, 3)), (219027804, Decimal('55.942460'), Decimal('11.866298'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(212008000, Decimal('55.579805'), Decimal('15.240362'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219003119, Decimal('57.139900'), Decimal('9.126967'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219017664, Decimal('56.701280'), Decimal('8.218468'), datetime.datetime(2020, 11, 18, 0, 0))], [(2190069, Decimal('57.003785'), Decimal('9.824150'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(220010000, Decimal('55.918467'), Decimal('10.958250'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(265797590, Decimal('55.867897'), Decimal('12.823597'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(211750690, Decimal('54.991955'), Decimal('8.176557'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(538008427, Decimal('56.125627'), Decimal('12.496787'), datetime.datetime(2020, 11, 18, 0, 0))], [(219005465, Decimal('54.572602'), Decimal('11.929218'), datetime.datetime(2020, 11, 18, 0, 0))], [(306813000, Decimal('54.781467'), Decimal('15.463233'), datetime.datetime(2020, 11, 18, 0, 0))], [(265714460, Decimal('55.675625'), Decimal('13.058785'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219026443, Decimal('55.279032'), Decimal('14.839220'), datetime.datetime(2020, 11, 18, 0, 0, 1)), (219026443, Decimal('55.279022'), Decimal('14.839463'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(230632000, Decimal('55.025453'), Decimal('13.736820'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(220333000, Decimal('57.717630'), Decimal('10.587007'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(209114000, Decimal('54.331537'), Decimal('9.729725'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(992111842, Decimal('54.630667'), Decimal('12.691883'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219008904, Decimal('55.061310'), Decimal('10.618688'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219000429, Decimal('54.581767'), Decimal('11.282167'), datetime.datetime(2020, 11, 18, 0, 0))], [(236500000, Decimal('55.180128'), Decimal('13.517667'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(235104964, Decimal('54.995107'), Decimal('11.874073'), datetime.datetime(2020, 11, 18, 0, 0))], [(219017895, Decimal('57.119032'), Decimal('8.592773'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(259488000, Decimal('55.096003'), Decimal('9.988937'), datetime.datetime(2020, 11, 18, 0, 0, 4)), (259488000, Decimal('55.096065'), Decimal('9.988803'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219381000, Decimal('55.477338'), Decimal('8.416992'), datetime.datetime(2020, 11, 18, 0, 0, 3)), (219381000, Decimal('55.477337'), Decimal('8.416990'), datetime.datetime(2020, 11, 18, 0, 0))], [(220142000, Decimal('57.492637'), Decimal('10.505057'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219083000, Decimal('55.002233'), Decimal('11.013900'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(636016149, Decimal('57.796877'), Decimal('8.533202'), datetime.datetime(2020, 11, 18, 0, 0))], [(265768840, Decimal('55.410727'), Decimal('12.933283'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(215211000, Decimal('57.553857'), Decimal('11.284468'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219945000, Decimal('57.671167'), Decimal('10.795367'), datetime.datetime(2020, 11, 18, 0, 0))], [(219536000, Decimal('56.004903'), Decimal('8.120140'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219005059, Decimal('56.091623'), Decimal('12.503235'), datetime.datetime(2020, 11, 18, 0, 0))], [(265527470, Decimal('56.199217'), Decimal('12.546092'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219006092, Decimal('57.122842'), Decimal('8.599410'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219015298, Decimal('55.475698'), Decimal('14.902088'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219005921, Decimal('56.127617'), Decimal('12.309128'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(636091917, Decimal('57.281822'), Decimal('8.786063'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000818, Decimal('55.270355'), Decimal('9.889317'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219019887, Decimal('55.864783'), Decimal('10.548833'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(992191524, Decimal('55.720382'), Decimal('4.799932'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(244224000, Decimal('56.535932'), Decimal('11.704497'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219435000, Decimal('57.839965'), Decimal('10.826355'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219013885, Decimal('57.715715'), Decimal('10.585258'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219009738, Decimal('57.122702'), Decimal('8.599558'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(218176000, Decimal('56.704625'), Decimal('8.177562'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(565359000, Decimal('57.640975'), Decimal('11.158420'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219358000, Decimal('57.703048'), Decimal('9.849727'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(235104985, Decimal('55.253468'), Decimal('12.374587'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265759020, Decimal('55.675662'), Decimal('13.058597'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(235090202, Decimal('54.631917'), Decimal('11.353632'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(218768000, Decimal('54.800100'), Decimal('10.146383'), datetime.datetime(2020, 11, 18, 0, 0))], [(231701000, Decimal('58.473157'), Decimal('10.039965'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(311000263, Decimal('56.470700'), Decimal('11.754883'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219022256, Decimal('54.572050'), Decimal('11.928838'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(273411400, Decimal('55.158917'), Decimal('12.897063'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219013977, Decimal('56.968172'), Decimal('9.247155'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219012521, Decimal('56.701357'), Decimal('8.220205'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(636017523, Decimal('57.425500'), Decimal('9.107167'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(244089000, Decimal('57.077635'), Decimal('8.203543'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265041000, Decimal('56.037315'), Decimal('12.651683'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(331569000, Decimal('55.059240'), Decimal('10.621330'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(246430000, Decimal('57.147058'), Decimal('8.319127'), datetime.datetime(2020, 11, 18, 0, 0))], [(266266000, Decimal('55.642660'), Decimal('15.223570'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219002786, Decimal('56.000552'), Decimal('8.128863'), datetime.datetime(2020, 11, 18, 0, 0))], [(230948000, Decimal('54.320787'), Decimal('9.714947'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(246854000, Decimal('54.822067'), Decimal('10.223530'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(273418960, Decimal('54.638938'), Decimal('11.375737'), datetime.datetime(2020, 11, 18, 0, 0))], [(265463000, Decimal('55.044803'), Decimal('12.717630'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(210169000, Decimal('57.872000'), Decimal('9.220863'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(220272000, Decimal('55.501920'), Decimal('9.654180'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(209864000, Decimal('54.955677'), Decimal('13.932805'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219922000, Decimal('56.003977'), Decimal('8.123532'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219000647, Decimal('55.042343'), Decimal('9.423320'), datetime.datetime(2020, 11, 18, 0, 0))], [(265705100, Decimal('55.756607'), Decimal('12.903682'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219005902, Decimal('57.592898'), Decimal('9.961927'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(244020000, Decimal('55.277167'), Decimal('12.835167'), datetime.datetime(2020, 11, 18, 0, 0))], [(257349500, Decimal('57.592795'), Decimal('9.957018'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000811, Decimal('54.916057'), Decimal('11.359973'), datetime.datetime(2020, 11, 18, 0, 0))], [(219002587, Decimal('55.254288'), Decimal('12.373192'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265756000, Decimal('55.855783'), Decimal('12.833833'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(305541000, Decimal('54.499252'), Decimal('11.576540'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(244234000, Decimal('56.175183'), Decimal('12.458667'), datetime.datetime(2020, 11, 18, 0, 0))], [(219006835, Decimal('57.320783'), Decimal('11.126337'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219191000, Decimal('56.357727'), Decimal('7.496345'), datetime.datetime(2020, 11, 18, 0, 0, 4)), (219191000, Decimal('56.357760'), Decimal('7.496397'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219005787, Decimal('57.439205'), Decimal('10.549683'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(211329270, Decimal('56.207050'), Decimal('12.161500'), datetime.datetime(2020, 11, 18, 0, 0))], [(219024675, Decimal('57.439292'), Decimal('10.549732'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219001559, Decimal('56.696703'), Decimal('8.218563'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219002827, Decimal('57.717482'), Decimal('10.587310'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(304858000, Decimal('55.218332'), Decimal('13.371672'), datetime.datetime(2020, 11, 18, 0, 0))], [(235099967, Decimal('55.253668'), Decimal('12.374780'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219005453, Decimal('57.439585'), Decimal('10.549348'), datetime.datetime(2020, 11, 18, 0, 0))], [(244130526, Decimal('54.332798'), Decimal('9.963602'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(235059487, Decimal('54.659110'), Decimal('12.424603'), datetime.datetime(2020, 11, 18, 0, 0))], [(219026000, Decimal('55.449590'), Decimal('12.298028'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(209543000, Decimal('55.112073'), Decimal('14.272933'), datetime.datetime(2020, 11, 18, 0, 0)), (209543000, Decimal('55.112185'), Decimal('14.273108'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219025535, Decimal('56.693075'), Decimal('8.219762'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(258849000, Decimal('55.343217'), Decimal('12.632650'), datetime.datetime(2020, 11, 18, 0, 0))], [(304846000, Decimal('55.969240'), Decimal('12.730157'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219013391, Decimal('57.715558'), Decimal('10.587172'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(209275000, Decimal('55.465768'), Decimal('15.088130'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219006382, Decimal('56.701313'), Decimal('8.222777'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219001149, Decimal('57.320323'), Decimal('11.124590'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219002415, Decimal('56.704418'), Decimal('8.222187'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(245693000, Decimal('54.637342'), Decimal('11.355177'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219007705, Decimal('55.714662'), Decimal('10.017003'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(244860678, Decimal('54.656707'), Decimal('11.351145'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219000543, Decimal('57.321127'), Decimal('11.124412'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(2190076, Decimal('55.674637'), Decimal('9.502010'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(244291000, Decimal('55.748362'), Decimal('12.683507'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(220076000, Decimal('55.258048'), Decimal('11.080813'), datetime.datetime(2020, 11, 18, 0, 0))], [(219421000, Decimal('57.718337'), Decimal('10.599188'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219022257, Decimal('57.718120'), Decimal('10.592765'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(211245200, Decimal('54.583848'), Decimal('12.320117'), datetime.datetime(2020, 11, 18, 0, 0))], [(219018486, Decimal('57.120967'), Decimal('8.601250'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(235102628, Decimal('54.656450'), Decimal('11.350850'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219002857, Decimal('55.679138'), Decimal('12.593578'), datetime.datetime(2020, 11, 18, 0, 0))], [(992191530, Decimal('55.804082'), Decimal('4.564250'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000166, Decimal('56.493048'), Decimal('8.598582'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(266148000, Decimal('57.329908'), Decimal('11.454297'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219997000, Decimal('56.073422'), Decimal('10.817943'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(354749000, Decimal('56.680730'), Decimal('8.230190'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219008746, Decimal('56.609207'), Decimal('10.300450'), datetime.datetime(2020, 11, 18, 0, 0))], [(219023635, Decimal('57.720800'), Decimal('10.594683'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(220024000, Decimal('56.533730'), Decimal('10.712848'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(244190093, Decimal('57.403315'), Decimal('8.671508'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(211190000, Decimal('54.639550'), Decimal('11.330283'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(249579000, Decimal('54.968268'), Decimal('13.886702'), datetime.datetime(2020, 11, 18, 0, 0))], [(992111840, Decimal('54.612910'), Decimal('12.629970'), datetime.datetime(2020, 11, 18, 0, 0, 3)), (992111840, Decimal('54.612913'), Decimal('12.629970'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219762000, Decimal('58.125583'), Decimal('10.567917'), datetime.datetime(2020, 11, 18, 0, 0)), (219762000, Decimal('58.125567'), Decimal('10.567950'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(229964000, Decimal('54.664513'), Decimal('13.068712'), datetime.datetime(2020, 11, 18, 0, 0))], [(219330000, Decimal('56.695317'), Decimal('8.219348'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219017582, Decimal('54.656588'), Decimal('11.351058'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(220338000, Decimal('56.128170'), Decimal('12.309343'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219013226, Decimal('55.720147'), Decimal('11.708147'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(2190064, Decimal('56.716568'), Decimal('11.519052'), datetime.datetime(2020, 11, 18, 0, 0))], [(2573115, Decimal('59.233333'), Decimal('9.700000'), datetime.datetime(2020, 11, 18, 0, 0))], [(219005671, Decimal('57.120687'), Decimal('8.600233'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(212240000, Decimal('55.458310'), Decimal('14.644500'), datetime.datetime(2020, 11, 18, 0, 0))], [(219024194, Decimal('57.720313'), Decimal('10.594232'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2614700, Decimal('54.094723'), Decimal('15.063923'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(211457860, Decimal('54.362730'), Decimal('9.819487'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(538003432, Decimal('56.254350'), Decimal('11.103033'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(2190045, Decimal('55.471767'), Decimal('8.423305'), datetime.datetime(2020, 11, 18, 0, 0))], [(219005616, Decimal('57.123163'), Decimal('8.599722'), datetime.datetime(2020, 11, 18, 0, 0))], [(211343680, Decimal('54.285700'), Decimal('11.767967'), datetime.datetime(2020, 11, 18, 0, 0))], [(219020187, Decimal('56.795508'), Decimal('8.864727'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219002493, Decimal('55.425550'), Decimal('10.384717'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(266128000, Decimal('57.683233'), Decimal('11.648350'), datetime.datetime(2020, 11, 18, 0, 0))], [(2573125, Decimal('58.433333'), Decimal('8.766667'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(236597000, Decimal('57.503783'), Decimal('10.730292'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219001647, Decimal('54.146677'), Decimal('12.114207'), datetime.datetime(2020, 11, 18, 0, 0))], [(636092156, Decimal('54.431572'), Decimal('12.139258'), datetime.datetime(2020, 11, 18, 0, 0))], [(219016759, Decimal('56.408810'), Decimal('10.925183'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(265509710, Decimal('57.744078'), Decimal('11.641297'), datetime.datetime(2020, 11, 18, 0, 0))], [(2655146, Decimal('56.789980'), Decimal('12.937965'), datetime.datetime(2020, 11, 18, 0, 0))], [(220614000, Decimal('57.703120'), Decimal('10.659543'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(246371000, Decimal('54.285072'), Decimal('11.852355'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219423000, Decimal('54.573667'), Decimal('11.924733'), datetime.datetime(2020, 11, 18, 0, 0))], [(219168000, Decimal('56.695783'), Decimal('8.219043'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219025741, Decimal('55.849863'), Decimal('12.574093'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219018811, Decimal('56.016202'), Decimal('12.685793'), datetime.datetime(2020, 11, 18, 0, 0, 3)), (219018811, Decimal('56.016212'), Decimal('12.685935'), datetime.datetime(2020, 11, 18, 0, 0))], [(219018636, Decimal('56.000927'), Decimal('8.122898'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(375103000, Decimal('56.677137'), Decimal('8.227293'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(211301380, Decimal('53.981017'), Decimal('8.459167'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219016832, Decimal('55.211857'), Decimal('11.198303'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219024715, Decimal('57.718228'), Decimal('10.587317'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(265507770, Decimal('57.599527'), Decimal('11.793920'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(220124000, Decimal('55.059978'), Decimal('10.619615'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219024175, Decimal('55.516188'), Decimal('10.569970'), datetime.datetime(2020, 11, 18, 0, 0))], [(220012000, Decimal('56.409622'), Decimal('10.924392'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(311648000, Decimal('55.353857'), Decimal('14.594665'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(232014085, Decimal('55.472458'), Decimal('8.426392'), datetime.datetime(2020, 11, 18, 0, 0))], [(219019804, Decimal('54.751450'), Decimal('10.670950'), datetime.datetime(2020, 11, 18, 0, 0))], [(376083000, Decimal('54.214262'), Decimal('12.010343'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219000674, Decimal('54.891570'), Decimal('10.412888'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219007362, Decimal('57.716487'), Decimal('10.597963'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219013964, Decimal('55.061085'), Decimal('10.619273'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(244678000, Decimal('55.173180'), Decimal('14.282213'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(220304000, Decimal('56.715758'), Decimal('11.512313'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219570000, Decimal('55.078480'), Decimal('12.814233'), datetime.datetime(2020, 11, 18, 0, 0))], [(2655150, Decimal('57.693972'), Decimal('12.058618'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2655021, Decimal('58.357077'), Decimal('11.252857'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(305555000, Decimal('54.941928'), Decimal('16.078860'), datetime.datetime(2020, 11, 18, 0, 0))], [(314036000, Decimal('55.486132'), Decimal('4.973538'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(218809000, Decimal('55.888157'), Decimal('15.212402'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219004266, Decimal('55.478627'), Decimal('8.420787'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(2190052, Decimal('54.872390'), Decimal('11.196887'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(218706000, Decimal('54.590547'), Decimal('10.860492'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(211718360, Decimal('55.050345'), Decimal('9.895192'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219001749, Decimal('55.725212'), Decimal('11.760210'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(230916000, Decimal('54.444590'), Decimal('11.994752'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(636014189, Decimal('55.002167'), Decimal('14.048833'), datetime.datetime(2020, 11, 18, 0, 0))], [(219000741, Decimal('54.816817'), Decimal('11.016967'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(305261000, Decimal('54.779918'), Decimal('13.118512'), datetime.datetime(2020, 11, 18, 0, 0))], [(219003826, Decimal('56.386587'), Decimal('11.026517'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2190074, Decimal('57.738658'), Decimal('10.574665'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(563093300, Decimal('55.777052'), Decimal('10.810595'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(220368000, Decimal('57.494173'), Decimal('10.501927'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219872000, Decimal('56.697715'), Decimal('8.218058'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219009599, Decimal('57.593623'), Decimal('9.957008'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219011225, Decimal('56.004847'), Decimal('8.122548'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(220223000, Decimal('57.602383'), Decimal('9.540578'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219017815, Decimal('55.965938'), Decimal('11.844705'), datetime.datetime(2020, 11, 18, 0, 0))], [(246555000, Decimal('56.823173'), Decimal('8.046412'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219025740, Decimal('55.720230'), Decimal('11.721482'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(265570730, Decimal('57.108703'), Decimal('12.242875'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(209151000, Decimal('55.427755'), Decimal('14.785120'), datetime.datetime(2020, 11, 18, 0, 0))], [(219948000, Decimal('58.073785'), Decimal('10.654160'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(244850855, Decimal('56.428852'), Decimal('12.320868'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(2655135, Decimal('55.478315'), Decimal('13.270352'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219021176, Decimal('57.593343'), Decimal('9.960972'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219012302, Decimal('56.127000'), Decimal('12.309167'), datetime.datetime(2020, 11, 18, 0, 0))], [(992191519, Decimal('55.606082'), Decimal('4.491350'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219024178, Decimal('54.571810'), Decimal('11.928702'), datetime.datetime(2020, 11, 18, 0, 0))], [(219018258, Decimal('55.260575'), Decimal('9.729657'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(5322, Decimal('55.684753'), Decimal('12.605772'), datetime.datetime(2020, 11, 18, 0, 0))], [(244521000, Decimal('53.828677'), Decimal('9.352687'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219106000, Decimal('57.593103'), Decimal('9.957272'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(244130689, Decimal('54.168150'), Decimal('11.384727'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000618, Decimal('56.701903'), Decimal('8.218878'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219013539, Decimal('57.863108'), Decimal('10.638098'), datetime.datetime(2020, 11, 18, 0, 0))], [(219000584, Decimal('55.879927'), Decimal('11.137567'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219013178, Decimal('55.945968'), Decimal('10.728205'), datetime.datetime(2020, 11, 18, 0, 0))], [(219777000, Decimal('56.128492'), Decimal('12.309720'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(257961000, Decimal('55.003160'), Decimal('12.809015'), datetime.datetime(2020, 11, 18, 0, 0))], [(219837000, Decimal('57.122752'), Decimal('8.598000'), datetime.datetime(2020, 11, 18, 0, 0))], [(219005904, Decimal('56.041787'), Decimal('12.613087'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219022265, Decimal('55.737443'), Decimal('12.662725'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(246824000, Decimal('57.208592'), Decimal('8.385168'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219001182, Decimal('55.822582'), Decimal('10.063905'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(244264000, Decimal('55.178710'), Decimal('14.077058'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(230631000, Decimal('54.241147'), Decimal('11.643925'), datetime.datetime(2020, 11, 18, 0, 0))], [(219005732, Decimal('57.717935'), Decimal('10.586275'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219005866, Decimal('57.320527'), Decimal('11.123572'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(220359000, Decimal('57.495870'), Decimal('10.501518'), datetime.datetime(2020, 11, 18, 0, 0))], [(244265000, Decimal('55.522592'), Decimal('15.068637'), datetime.datetime(2020, 11, 18, 0, 0))], [(219005583, Decimal('57.715512'), Decimal('10.584823'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(277560000, Decimal('56.127878'), Decimal('11.415067'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219023945, Decimal('54.933373'), Decimal('10.832642'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(250000962, Decimal('57.819300'), Decimal('9.260667'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000000, Decimal('57.717625'), Decimal('10.590210'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(211609560, Decimal('55.016448'), Decimal('8.439438'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(236673000, Decimal('55.864923'), Decimal('10.867223'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219007456, Decimal('56.371513'), Decimal('8.120080'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(220046000, Decimal('57.321627'), Decimal('11.127652'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(209071000, Decimal('54.657183'), Decimal('11.350150'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265628170, Decimal('55.624630'), Decimal('13.034467'), datetime.datetime(2020, 11, 18, 0, 0))], [(212510000, Decimal('57.714567'), Decimal('9.267118'), datetime.datetime(2020, 11, 18, 0, 0))], [(235006758, Decimal('57.591635'), Decimal('9.953810'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(220490000, Decimal('56.606580'), Decimal('8.088727'), datetime.datetime(2020, 11, 18, 0, 0))], [(305184000, Decimal('54.612788'), Decimal('14.267473'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(477261300, Decimal('57.314417'), Decimal('8.045267'), datetime.datetime(2020, 11, 18, 0, 0))], [(220278000, Decimal('57.491893'), Decimal('10.505793'), datetime.datetime(2020, 11, 18, 0, 0))], [(248372000, Decimal('56.874693'), Decimal('11.830645'), datetime.datetime(2020, 11, 18, 0, 0))], [(219004242, Decimal('56.533483'), Decimal('10.713782'), datetime.datetime(2020, 11, 18, 0, 0))], [(265750000, Decimal('55.557392'), Decimal('14.357867'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(265527920, Decimal('57.744483'), Decimal('11.642003'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(265540720, Decimal('57.818043'), Decimal('11.879603'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219005477, Decimal('56.152867'), Decimal('10.216250'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219000852, Decimal('55.012403'), Decimal('14.587163'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(250105600, Decimal('57.717950'), Decimal('10.590947'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(229612000, Decimal('54.684132'), Decimal('15.510735'), datetime.datetime(2020, 11, 18, 0, 0))], [(219159000, Decimal('55.027747'), Decimal('10.395548'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265522230, Decimal('57.699503'), Decimal('11.666933'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219012639, Decimal('56.409012'), Decimal('10.921902'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(273310900, Decimal('54.716848'), Decimal('12.525397'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(636092297, Decimal('55.244508'), Decimal('12.967945'), datetime.datetime(2020, 11, 18, 0, 0))], [(220623000, Decimal('56.004532'), Decimal('8.122168'), datetime.datetime(2020, 11, 18, 0, 0))], [(248524000, Decimal('56.946833'), Decimal('7.816667'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(266343000, Decimal('56.187627'), Decimal('11.270918'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000183, Decimal('54.996857'), Decimal('11.886927'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(311027600, Decimal('54.991007'), Decimal('14.041148'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(244239000, Decimal('56.070297'), Decimal('7.114718'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(209210000, Decimal('55.405683'), Decimal('14.521073'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219009135, Decimal('57.122378'), Decimal('8.599922'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(249934000, Decimal('56.903117'), Decimal('8.173917'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2190077, Decimal('55.149090'), Decimal('14.879122'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219022000, Decimal('58.164685'), Decimal('10.206523'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219616000, Decimal('55.738573'), Decimal('5.455565'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(257385000, Decimal('55.219403'), Decimal('13.127725'), datetime.datetime(2020, 11, 18, 0, 0))], [(256600000, Decimal('56.016340'), Decimal('12.685022'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219007572, Decimal('56.127372'), Decimal('12.310442'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(209664000, Decimal('54.429803'), Decimal('11.693033'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(266473000, Decimal('56.321117'), Decimal('12.251283'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(220067000, Decimal('56.551412'), Decimal('8.307450'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(209445000, Decimal('57.250978'), Decimal('11.599930'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(231836000, Decimal('57.049550'), Decimal('10.060625'), datetime.datetime(2020, 11, 18, 0, 0))], [(219001459, Decimal('55.372918'), Decimal('13.144832'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(212801000, Decimal('56.320878'), Decimal('7.476075'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(244813000, Decimal('55.529000'), Decimal('12.698167'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(261005510, Decimal('56.001373'), Decimal('8.124338'), datetime.datetime(2020, 11, 18, 0, 0))], [(219047000, Decimal('55.462062'), Decimal('8.438643'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219023588, Decimal('57.118328'), Decimal('8.594223'), datetime.datetime(2020, 11, 18, 0, 0))], [(636018545, Decimal('55.180037'), Decimal('11.046230'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219023834, Decimal('54.933897'), Decimal('10.833697'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(265547250, Decimal('57.704570'), Decimal('11.939400'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219003103, Decimal('55.448842'), Decimal('10.661700'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(255806272, Decimal('55.052673'), Decimal('13.994587'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219005956, Decimal('56.126052'), Decimal('12.311410'), datetime.datetime(2020, 11, 18, 0, 0))], [(253665000, Decimal('53.858183'), Decimal('9.028433'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219006116, Decimal('55.242397'), Decimal('11.092420'), datetime.datetime(2020, 11, 18, 0, 0))], [(266050000, Decimal('57.732747'), Decimal('11.672115'), datetime.datetime(2020, 11, 18, 0, 0))], [(992191518, Decimal('55.767517'), Decimal('4.648298'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(266319000, Decimal('57.058867'), Decimal('12.273817'), datetime.datetime(2020, 11, 18, 0, 0))], [(219002783, Decimal('56.371518'), Decimal('8.120032'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219000809, Decimal('54.935705'), Decimal('11.373223'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219023833, Decimal('55.677392'), Decimal('11.082668'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(211149000, Decimal('55.370783'), Decimal('13.148567'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219000733, Decimal('54.941752'), Decimal('10.259727'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(244780000, Decimal('56.295810'), Decimal('12.397002'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219000881, Decimal('54.933480'), Decimal('10.833365'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(306117000, Decimal('55.443848'), Decimal('12.658507'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219005867, Decimal('57.717335'), Decimal('10.586895'), datetime.datetime(2020, 11, 18, 0, 0))], [(255805899, Decimal('57.478323'), Decimal('9.329788'), datetime.datetime(2020, 11, 18, 0, 0))], [(258687000, Decimal('54.993403'), Decimal('13.005787'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219002023, Decimal('57.594180'), Decimal('9.958015'), datetime.datetime(2020, 11, 18, 0, 0))], [(220273000, Decimal('55.972172'), Decimal('11.370575'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(219003879, Decimal('56.154405'), Decimal('10.214303'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219456000, Decimal('55.450267'), Decimal('8.468500'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(265504660, Decimal('56.044717'), Decimal('12.687667'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(605086070, Decimal('57.446397'), Decimal('8.571142'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219021235, Decimal('56.860195'), Decimal('12.099747'), datetime.datetime(2020, 11, 18, 0, 0))], [(277408000, Decimal('54.415000'), Decimal('12.089390'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219036000, Decimal('53.874317'), Decimal('7.851383'), datetime.datetime(2020, 11, 18, 0, 0))], [(219024784, Decimal('56.409207'), Decimal('10.925070'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000603, Decimal('55.460807'), Decimal('8.439757'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(357909000, Decimal('56.597908'), Decimal('7.385315'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219000617, Decimal('55.088233'), Decimal('8.564835'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(218728000, Decimal('57.614628'), Decimal('10.739667'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2190066, Decimal('56.530067'), Decimal('8.166947'), datetime.datetime(2020, 11, 18, 0, 0))], [(374558000, Decimal('54.504600'), Decimal('11.507950'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(538004542, Decimal('55.452707'), Decimal('10.941133'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(219002838, Decimal('55.472122'), Decimal('8.425653'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(273390790, Decimal('55.200847'), Decimal('13.504545'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(236608000, Decimal('54.361887'), Decimal('10.063228'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(372078000, Decimal('57.462568'), Decimal('8.426597'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(314431000, Decimal('54.547005'), Decimal('12.397808'), datetime.datetime(2020, 11, 18, 0, 0))], [(219063000, Decimal('56.001120'), Decimal('8.130628'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(266057000, Decimal('56.929187'), Decimal('12.352502'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(266440000, Decimal('57.718953'), Decimal('10.600380'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219009229, Decimal('55.253255'), Decimal('12.374358'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219025245, Decimal('57.740125'), Decimal('10.126838'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(2655130, Decimal('55.668072'), Decimal('14.158132'), datetime.datetime(2020, 11, 18, 0, 0, 1))], [(219000734, Decimal('57.296783'), Decimal('10.922267'), datetime.datetime(2020, 11, 18, 0, 0, 2))], [(220622000, Decimal('56.369012'), Decimal('8.120885'), datetime.datetime(2020, 11, 18, 0, 0))], [(265411000, Decimal('55.239248'), Decimal('12.886677'), datetime.datetime(2020, 11, 18, 0, 0, 4))], [(250002033, Decimal('57.047000'), Decimal('12.017167'), datetime.datetime(2020, 11, 18, 0, 0, 3))], [(219018405, Decimal('57.716150'), Decimal('10.586342'), datetime.datetime(2020, 11, 18, 0, 0))]]"
        #query = "SELECT DISTINCT MMSI FROM AISDraft.POSITION_REPORT, AISDraft.AIS_MESSAGE WHERE POSITION_REPORT.AISMessage_Id = AIS_MESSAGE.Id GROUP BY MMSI;"
        #actual = mysqlutils.SQL_runner().run(query)

        self.assertFalse(error)

    def test_read_vessel_information(self):
        expected = "[(9229063, 'Netherlands', 'Thun Galaxy', 2001, None, 114, 15, 4107, 244089000, 'Chemical/Oil Tanker', 'Active', '17821')]"
        actual = tmb_dao.tmb_dao().read_vessel_information(244089000)
        self.assertEqual(expected, str(actual))

    def test_read_port_by_name(self):
        expected = "[(5016, 'NULL', 'Jyllinge', 'Denmark', Decimal('12.096111'), Decimal('55.745000'), 'www.jyllingehavn.dk', 1, 5528, 55283)]"
        actual = tmb_dao.tmb_dao().read_port_by_name("Jyllinge")
        self.assertEqual(expected, str(actual))

    def test_get_tile_file(self):
        expected = '38F7.png'
        actual = tmb_dao.tmb_dao().get_tile_file(5036)
        self.assertEqual(expected, str(actual))

    def test_read_position_of_ships_headed_to_port(self):
        expected = """[[(219023635, Decimal('57.720800'), Decimal('10.594683'), datetime.datetime(2020, 11, 18, 0, 0, 2))]]"""
        actual = tmb_dao.tmb_dao().read_positions_of_ships_headed_to_port("HANSTHOLM")
        self.assertEqual(expected, str(actual))

    def test_read_position_of_ships_headed_to_port_id(self):
        expected = "[[(219023635, Decimal('57.720800'), Decimal('10.594683'), datetime.datetime(2020, 11, 18, 0, 0, 2))]]"
        actual = str(tmb_dao.tmb_dao().read_positions_of_ships_headed_to_port_id(2974))
        self.assertEqual(expected, actual)

    def test_read_ship_positions_in_tile(self):
        expected = "[[(9608673, 'Marshall Islands', 'Ionic Hawk', 2012, None, 180, 30, 22432, 538004542, 'Bulk Carrier', 'Active', '20820')]]"
        actual = str(tmb_dao.tmb_dao().read_ship_positions_in_tile(53312))
        self.assertEqual(expected, actual)

    def test_read_ship_positions_by_port(self):
        expected = "[[(9608673, 'Marshall Islands', 'Ionic Hawk', 2012, None, 180, 30, 22432, 538004542, 'Bulk Carrier', 'Active', '20820')]]"
        actual = str(tmb_dao.tmb_dao().read_ship_positions_by_port("Munkebo"))
        self.assertEqual(expected, actual)

    def test_read_level_3_tiles(self):
        expected = "[50361, 50362, 50363, 50364]"
        actual = str(tmb_dao.tmb_dao().read_level_3_tiles(5036))
        self.assertEqual(expected, actual)

    def test_y_delete_ais_older_than_five_minutes(self):
        expected = "[(500,)]"
        actual = str(tmb_dao.tmb_dao().delete_ais_older_than_five_minutes("2020-11-18 00:09:00"))
        self.assertEqual(expected, actual)


    # Test for insert.msg()
    def test_insert_message_fail(self):
        error = False
        ex = '{"Timstamp":"2020-11-18T00:00:00.000Z","Class":"Class A","MMSI":244265000,"MsgType":"position_report", \
                     "Position":{"type":"Point","coordinates":[55.522592,15.068637]},"Status":"Under way using engine","RoT":2.2,"SoG":14.8,"CoG":62,"Heading":61}'
        try:
            tmb_dao.tmb_dao().insert_msg(ex, 0)
        except KeyError:
            error = True
        self.assertTrue(error)

    # Test successful insert for insert_msg()
    def test_z_insert_message(self):
        ex = '{"Timestamp":"2020-11-18T00:00:00.000Z","Class":"Class A","MMSI":244265000,"MsgType":"position_report", \
                             "Position":{"type":"Point","coordinates":[55.522592,15.068637]},"Status":"Under way using engine","RoT":2.2,"SoG":14.8,"CoG":62,"Heading":61}'
        tmb_dao.tmb_dao().insert_msg(ex, 0)
        expected = "[(datetime.datetime(2020, 11, 18, 0, 0), 'Under way using engine')]"
        query = "SELECT AISDraft.ais_message.Timestamp, AISDraft.position_report.Navigationalstatus FROM AISDraft.ais_message, AISDraft.position_report WHERE AISDraft.ais_message.MMSI=244265000 AND AISDraft.ais_message.Id=AISDraft.position_report.AISMessage_Id;"
        actual = mysqlutils.SQL_runner().run(query)
        self.assertEqual(expected, str(actual))

    # Test for insert_message_batch()
    # Test successful insert for insert_message_batch()
    def test_insert_message_batch(self):
        tmb_dao.tmb_dao().insert_message_batch("sample_input.json")
        true_output = "[(datetime.datetime(2020, 11, 18, 0, 0), 'Under way using engine')]"
        query = "SELECT AISDraft.ais_message.timestamp, AISDraft.position_report.navigationalstatus FROM AISDraft.ais_message, AISDraft.position_report WHERE AISDraft.ais_message.mmsi=304858000 AND AISDraft.ais_message.id=AISDraft.position_report.aismessage_id;"
        program_output = mysqlutils.SQL_runner().run(query)
        self.assertEqual(true_output, str(program_output))

if __name__ == '__main__':
    test.main()
